"use strict";(self.webpackChunkbhq_ius_moodle=self.webpackChunkbhq_ius_moodle||[]).push([[847],{3847:(I,m,r)=>{r.r(m),r.d(m,{ReportModule:()=>w});var c=r(9808),u=r(9826),T=r(3470),f=r(3609),t=r(5e3),z=r(5207),_=r(7480),O=r(4630),k=r(7842),x=r(8480),P=r(5017),v=r(6042),R=r(2683),Z=r(2643),N=r(7484),C=r(5905),b=r(8054),h=r(2382),M=r(8197);function j(o,s){if(1&o&&t._UZ(0,"nz-option",19),2&o){const e=s.$implicit;t.Q6J("nzValue",e.name)("nzLabel",e.name)}}function L(o,s){if(1&o&&t._UZ(0,"nz-option",19),2&o){const e=s.$implicit;t.Q6J("nzValue",e.id)("nzLabel",e.name)}}function y(o,s){if(1&o&&t._UZ(0,"nz-option",19),2&o){const e=s.$implicit;t.Q6J("nzValue",e.id)("nzLabel",e.teamName)}}function D(o,s){if(1&o&&(t.TgZ(0,"nz-card",16),t._UZ(1,"highcharts-chart",17),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("Highcharts",e.Highcharts)("options",e.barChartOptions)}}const A=[{path:"",component:(()=>{class o{constructor(e,n,i,a,l){this.taskData=e,this.projectData=n,this.teamData=i,this.memberData=a,this.reportData=l,this.date=null,this.isAdvanced=!1,this.loading=!0,this.memberValue="",this.projectValue="",this.teamValue="",this.taskList=[],this.inCplTask=[],this.taskNumber=0,this.inCplTaskNumber=0,this.projectList=[],this.teamList=[],this.memberList=[],this.reportList=[],this.pageNumber=1,this.pageSize=999,this.txtProjectSearch="",this.txtTaskSearch="",this.txtTeamSearch="",this.txtMemberSearch="",this.txtReportSearch="",this.txtReportSort="",this.sortProject="",this.sortTask="",this.Highcharts=T}ngOnInit(){this.getReport(),this.getTask(),this.pieChartOption(),this.getTeam(),this.getProject(),this.getMember()}getWeek(e){console.log("week: ",e.map(f.Z))}getTask(){this.taskData.search(this.pageNumber,this.pageSize,this.txtTaskSearch,this.sortTask).subscribe({next:e=>{console.log(e),this.taskList=e.pagingData.content},error:e=>{console.log(e)}})}getProject(){this.projectData.search(this.pageNumber,this.pageSize,this.txtProjectSearch,this.sortProject).subscribe({next:e=>{console.log(e),this.projectList=e.pagingData.content},error:e=>{console.log(e)}})}getTeam(){this.teamData.search(this.pageNumber,this.pageSize,this.txtTeamSearch).subscribe({next:e=>{console.log(e),this.teamList=e.pagingData.content},error:e=>{console.log(e)}})}getMember(){this.memberData.search(this.pageNumber,this.pageSize,this.txtMemberSearch).subscribe({next:e=>{console.log(e),this.memberList=e.pagingData.content},error:e=>{console.log(e)}})}getReport(){this.reportData.search(this.txtReportSearch,this.txtReportSort).subscribe({next:e=>{e&&(this.reportList=e.listData,this.taskNumber=e.listData.length,this.InCompleteTask(),this.barChartOption())},error:e=>{console.log(e)}})}search(){this.getReport(),this.txtReportSearch="",this.memberValue="",this.projectValue="",this.teamValue=""}getProjectValue(e){this.txtReportSearch+=`projectId.eq.${e},`}getMemberValue(e){this.txtReportSearch+=`username.eq.${e},`}getTeamValue(e){this.txtReportSearch+=`teamId.eq.${e},`}InCompleteTask(){this.inCplTask=[];for(let e=0;e<this.reportList.length;e++)0==this.reportList[e].state&&this.inCplTask.push(this.reportList[e]);this.inCplTaskNumber=this.inCplTask.length,this.pieChartOption()}exportExcel(){let e=Number(this.projectValue);this.reportData.exportExcel(e).subscribe({next:n=>{console.log(n);const i=n.type,a=[];a.push(n);const l=document.createElement("a");l.href=window.URL.createObjectURL(new Blob(a,{type:i})),l.setAttribute("download","test.xlsx"),document.body.appendChild(l),l.click()},error:n=>{console.log(n)}})}pieChartOption(){this.pieChartOptions={chart:{width:450,height:400,plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:"T\xecnh tr\u1ea1ng d\u1ef1 \xe1n",align:"left"},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},accessibility:{point:{valueSuffix:"%"}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %"}}},series:[{name:"T\u1ed5ng s\u1ed1 Task",colorByPoint:!0,data:[{name:"Task ho\xe0n th\xe0nh",y:this.taskNumber-this.inCplTaskNumber},{name:"Task ch\u01b0a ho\xe0n th\xe0nh",y:this.inCplTaskNumber}]}]}}barChartOption(){let e=[],n=[],i=[],a=[],l=0,d=0;for(let p=0;p<this.reportList.length;p++){let g=e.find(E=>E.projectId==this.reportList[p].projectId);null==g?0==this.reportList[p].state?(e.push({projectId:this.reportList[p].projectId,taskDone:l,taskNotDone:++d}),d=0):(e.push({projectId:this.reportList[p].projectId,taskDone:++l,taskNotDone:d}),l=0):0==this.reportList[p].state?g.taskNotDone++:g.taskDone++}for(let p=0;p<e.length;p++)n.push(e[p].projectId),i.push(e[p].taskDone),a.push(e[p].taskNotDone);this.barChartOptions={chart:{width:450,height:400,type:"column"},title:{text:"T\xecnh tr\u1ea1ng d\u1ef1 \xe1n",align:"left"},xAxis:{categories:n},yAxis:{min:0,title:{text:"Task"},stackLabels:{enabled:!0,style:{fontWeight:"bold",textOutline:"none"}}},tooltip:{headerFormat:"<b>{point.x}</b><br/>",pointFormat:"{series.name}: {point.y}<br/>T\u1ed5ng s\u1ed1 task: {point.stackTotal}"},plotOptions:{column:{stacking:"normal",dataLabels:{enabled:!0}}},series:[{name:"Task ho\xe0n th\xe0nh",data:i},{name:"Task ch\u01b0a ho\xe0n th\xe0nh",data:a}]},this.loading=!1}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(z.h),t.Y36(_.H),t.Y36(O.d),t.Y36(k.I),t.Y36(x.h))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-report"]],decls:38,vars:16,consts:[[1,"report-wrapper"],[1,"report-header","mt-4","mb-2"],["nzPlaceHolder","Nh\xe2n vi\xean",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzPlaceHolder","D\u1ef1 \xe1n",3,"ngModel","ngModelChange"],["nzPlaceHolder","Nh\xf3m",3,"ngModel","ngModelChange"],["nz-button","",1,"ml-2",3,"click"],["nzShape","circle","nz-button","",1,"filter","float-right",3,"click"],["nz-icon","","nzType","down","nzTheme","outline",3,"hidden"],["nz-icon","","nzType","up","nzTheme","outline",3,"hidden"],[1,"report-advanced-filter","mb-4",3,"hidden"],["nzMode","week",3,"ngModel","ngModelChange"],[1,"report-detail"],[1,"card-detail","mt-3"],["nzHoverable","",1,"card-item"],[1,"chart-detail"],["nzHoverable","",1,"chart-item"],[1,"highchart",3,"Highcharts","options"],["nzHoverable","","class","chart-item",4,"ngIf"],[3,"nzValue","nzLabel"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"nz-select",2),t.NdJ("ngModelChange",function(a){return n.memberValue=a})("ngModelChange",function(a){return n.getMemberValue(a)}),t.YNc(3,j,1,2,"nz-option",3),t.qZA(),t.TgZ(4,"nz-select",4),t.NdJ("ngModelChange",function(a){return n.projectValue=a})("ngModelChange",function(a){return n.getProjectValue(a)}),t.YNc(5,L,1,2,"nz-option",3),t.qZA(),t.TgZ(6,"nz-select",5),t.NdJ("ngModelChange",function(a){return n.teamValue=a})("ngModelChange",function(a){return n.getTeamValue(a)}),t.YNc(7,y,1,2,"nz-option",3),t.qZA(),t.TgZ(8,"button",6),t.NdJ("click",function(){return n.search()}),t._uU(9,"T\xecm ki\u1ebfm"),t.qZA(),t.TgZ(10,"button",6),t.NdJ("click",function(){return n.exportExcel()}),t._uU(11,"Xu\u1ea5t B\xe1o c\xe1o"),t.qZA(),t.TgZ(12,"button",7),t.NdJ("click",function(){return n.isAdvanced=!n.isAdvanced}),t._UZ(13,"i",8)(14,"i",9),t.qZA()(),t.TgZ(15,"div",10)(16,"nz-range-picker",11),t.NdJ("ngModelChange",function(a){return n.date=a})("ngModelChange",function(a){return n.getWeek(a)}),t.qZA()(),t.TgZ(17,"div",12)(18,"div",13)(19,"nz-card",14)(20,"h4"),t._uU(21,"T\u1ed5ng s\u1ed1 Task"),t.qZA(),t.TgZ(22,"span"),t._uU(23),t.qZA()(),t.TgZ(24,"nz-card",14)(25,"h4"),t._uU(26,"Task \u0111\xe3 ho\xe0n th\xe0nh"),t.qZA(),t.TgZ(27,"span"),t._uU(28),t.qZA()(),t.TgZ(29,"nz-card",14)(30,"h4"),t._uU(31,"Task ch\u01b0a ho\xe0n th\xe0nh"),t.qZA(),t.TgZ(32,"span"),t._uU(33),t.qZA()()(),t.TgZ(34,"div",15)(35,"nz-card",16),t._UZ(36,"highcharts-chart",17),t.qZA(),t.YNc(37,D,2,2,"nz-card",18),t.qZA()()()),2&e&&(t.xp6(2),t.Q6J("ngModel",n.memberValue),t.xp6(1),t.Q6J("ngForOf",n.memberList),t.xp6(1),t.Q6J("ngModel",n.projectValue),t.xp6(1),t.Q6J("ngForOf",n.projectList),t.xp6(1),t.Q6J("ngModel",n.teamValue),t.xp6(1),t.Q6J("ngForOf",n.teamList),t.xp6(6),t.Q6J("hidden",n.isAdvanced),t.xp6(1),t.Q6J("hidden",!n.isAdvanced),t.xp6(1),t.Q6J("hidden",!n.isAdvanced),t.xp6(1),t.Q6J("ngModel",n.date),t.xp6(7),t.Oqu(n.taskNumber),t.xp6(5),t.Oqu(n.taskNumber-n.inCplTaskNumber),t.xp6(5),t.Oqu(n.inCplTaskNumber),t.xp6(3),t.Q6J("Highcharts",n.Highcharts)("options",n.pieChartOptions),t.xp6(1),t.Q6J("ngIf",!n.loading&&n.barChartOptions))},dependencies:[c.sg,c.O5,P.Ls,v.ix,R.w,Z.dQ,N.bd,C.uw,C.wS,b.Ip,b.Vq,h.JJ,h.On,M.x],styles:[".report-wrapper[_ngcontent-%COMP%]{width:100%;padding:0 48px;margin-bottom:48px}.report-wrapper[_ngcontent-%COMP%]   .report-header[_ngcontent-%COMP%]   nz-select[_ngcontent-%COMP%]{margin:0 8px 10px 0;width:25%}.report-wrapper[_ngcontent-%COMP%]   .report-header[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]     .anticon svg{margin-bottom:5px}.report-wrapper[_ngcontent-%COMP%]   .report-advanced-filter[_ngcontent-%COMP%]   nz-range-picker[_ngcontent-%COMP%]{width:50.6%}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:25px}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]   .card-detail[_ngcontent-%COMP%]{width:100%;display:inline-flex;gap:25px}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]   .card-detail[_ngcontent-%COMP%]   .card-item[_ngcontent-%COMP%]{width:33%;height:200px;border:1px solid #edeae9!important;border-radius:8px}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]   .card-detail[_ngcontent-%COMP%]   .card-item[_ngcontent-%COMP%]     .ant-card-body{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;width:100%}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]   .card-detail[_ngcontent-%COMP%]   .card-item[_ngcontent-%COMP%]     .ant-card-body h4{font-size:20px;line-height:28px;font-weight:400}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]   .card-detail[_ngcontent-%COMP%]   .card-item[_ngcontent-%COMP%]     .ant-card-body span{font-size:48px;line-height:56px;font-weight:300}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]   .chart-detail[_ngcontent-%COMP%]{width:100%;display:inline-flex;gap:25px}.report-wrapper[_ngcontent-%COMP%]   .report-detail[_ngcontent-%COMP%]   .chart-detail[_ngcontent-%COMP%]   .chart-item[_ngcontent-%COMP%]{width:50%;height:450px;border:1px solid #edeae9!important;border-radius:8px;display:flex;justify-content:center}"]}),o})()}];let S=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[u.Bz.forChild(A),u.Bz]}),o})();var J=r(9923),V=r(9201);let w=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[c.ez,S,J.v,V.V,h.UX,h.u5,M.l]}),o})()}}]);